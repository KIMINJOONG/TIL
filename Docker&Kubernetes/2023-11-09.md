# 두 번째 컨테이너 & 로드 밸런서 배포하기

1. 작업하고이 있는 태스크 정의에 또 다른 컨테이너 추가, 선택한이름지정
2. 이미지는 그냥 mongo로 하면 됨
3. Port는 27017 매핑
4. mongo.env에 정의된 환경변수 추가
5. 데이터 지속을 위한 볼륨은 우선 그대로(설정에 아무것도 추가하지 않는다.)
6. 다른설정 그대로 두고 create
7. goals-app클러스터로 돌아가서 service를 생성
8. Fargate로 한 후 태스크 정의에서 방금 작업한 goals 태스크 선택
9. 서비스명은 goals-service
10. cluster VPC선택
11. 서브넷 선택
12. 로드밸런싱에서 애플리케이션 로드 밸런서 선택
    - 들어오는 트래픽 효율적으로 처리
    - 커스텀 도메인 할당하는데 도움
13. ec2 콘솔로 이동
14. 로드밸런서 생성
    - 이름 ecs-lb
    - internet-facing
    - 로드 밸런서는 포트 80을 노출
    - 서비스 생성시 선택한 VPC와 동일한 VPC연결 필요
      - 이렇게 해야만 동일한 네트워크에서 작동하도록 보장 가능
    - target type은 IP로 왜냐하면 실행중인 컨테이너를 위해 Fargate를 사용하기때문에 해야한다.
15. 생성이 완료되면 ecs로 돌아가서 선택해준다.
16. add to loadbalancer 클릭
17. 타깃 그룹에 추가
    - Auto Scaling은 들어오는 트래픽 급작스러운 증가에 대해 지연없이 급증을 처리할수있도록 더 많은 동시 컨테이너 인스턴스가 실행되도록 해줌(고급 기능 이번엔 사용 x)
