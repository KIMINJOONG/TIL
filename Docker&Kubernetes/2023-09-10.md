# "COPY" 사용 VS 바운드 마운트 사용

- 항상 사용하는 docker run 명령으로 컨테이너를 실행하면 전체 폴더를 바인드 마운트로 바인딩하여 코드 변경사항이 실행중인 컨테이너에 자동으로 반영됌. 그런데 Dockerfile의 모든항목을 COPY하는 이유는 무엇일까?
  **즉, 바인드 마운트로 전체 폴더를 볼륨으로 사용하는데 이미지가 생성될때 스냅샷에서 복사하는 이유는 무엇일까?**

- Dockerfile을 보면 node_modules 폴더를 유지하지만, 거기에 복사하지는 않는다. npm install로 생성할뿐, 그렇다면 COPY 단계가 제거 가능하지않을까?
  - 가능하다. 해당 명령을 주석하고 리빌드해보자
  ```
  docker build -t feedback-node:no-copy .
  ```
  컨테이너를 실행해보자
  ```
  docker  run -d --rm -p 3000:80 --name feedback-app -v feedback:/app/feedback -v "/Users/admin/TIL/Docker&Kubernetes/data-volumes-01-starting-setup:/app:ro" -v /app/node_modules -v /app/temp feedback-node:no-copy
  ```
  여전히 잘 작동하는것을 알 수 있다. 그러니 바인드 마운트를 사용하면 COPY명령을 제거 할 수 있다.

## 바인드 마운트에 잊지말아야 할 주요사항

- docker run 명령은 개발중에 사용하는 명령. 개발 중에 이 바인드 마운트를 사용하여 코드의 변경 사항을 실행중인 컨테이너에 즉시 반영. 개발을 마친뒤에는 실제로 이 컨테이너를 가져와 서버에 넣는다. 우리는 서버에서 그것을 실행하기를 원하지, 명령으로 실행하기를 원하지는 않는다. 즉, 바인드 마운트로 실행하지 않는다는말. 데이터가 유지되도록 다른 볼륨을 사용할수는 있으나, 바운드 마인트는 사용하지않을것이다. 컨테이너가 서버상의 제품상태로 즉 운영으로 실행중이라면 실행되는 동안 실시간으로 업데이트 되는 연결된 소스 코드가 없기때문이다.

- 프로덕션 환경, 실제로 제품을 사용하는 환경에서는 항상 코드의 스냅샷을 갖고있어야한다. 그것이 Dockerfile에 COPY명령을 유지하는 이유이다. 여전히 스냅샷 이미지를 만들어야하기때문이다. 따라서 코드의 스냅샷을 지닌 이미지는 프로덕션 환경에서 컨테이너를 가동하는데 사용.

- 또한, 개발 중에 바인드 마운트를 원한다면 그것도 작동한다. 하지만 프로덕션용 스냅샷 컨테이너를 생성하는 옵션은 반드시 필요하다.
