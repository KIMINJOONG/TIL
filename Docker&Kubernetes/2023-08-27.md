# DockerHub에 이미지 푸시

- 도커에는 이미지 공유를 위해 내장된 명령이 있다. 이미지를 공유할때 푸시할수있는 두가지 주요 위치가 존재한다. 도커허브 or 개인이 선택한 개인 레지스트리

1. 도커허브

   - 공식 도커 이미지 레지스트리
   - 공식 도커 이미지 레지스트리를 사용하여 이미지를 저장할수있으며, 공개 또는 비공개로도 저장할수 있다.

2. 개인 레지스트리

   - 들어오는 이미지를 처리하는 방법과 이미지를 저장하고 배포하는데 사용할수있는 수천개의 다른 서비스가 있는데 배포를 할때에는 보통 개인 레지스트리를 많이 사용한다.

   - 많은 공급자가 있고 도커 이미지를 지원하는 공급자를 사용할수도 있다. 따라서 모든 사람이 이러한 이미지를 볼 수 있는지 팀만 볼수있는지의 여부는 사용중인 제공업체에 따라 다르기때문에 실제 공급자에 달려있다.

- 어느쪽이든 도커 허브 또는 다른 공급자를 사용하든 상관없이 그 레지스트리에 이미지를 푸시하여 도커 허브 또는 다른 공급자에 이미지를 공유 할 수 있고 사용 할 수 있다. 이제 중요한것은 일반 이미지 리포지터리 이름으로 푸시 및 풀링하면 자동으로 도커 허브로 이동한다. 비공개 레지스트리나 다른 공급자에게 푸시하거나 풀 하려면 호스트를 포함해야하므로 푸시 풀 명령에 해당 공급자의 url이 포함되어야한다.

```
docker push ijboym216/node-hello-world
```

위의 명령어를 실행해보자. 로컬에 존재하지않는 저장소를 참조하고 있기때문에 에러가 발생한다. 해당 저장소는 도커허브에서 만들어진거지 로컬에 존재하는게 아니다. 그렇기때문에 도커에게 알려줘야하는데 이미지에 사용할 이름을 지정하기만 하면 된다. 여기서 이름은 도커 ID를 접두사로 지닌 이름이어야한다. 나의 경우에는 ijboym216/ 까지를 포함한 이름이 되어야한다.

```
docker build -t ijboym216/node-hello-world .
```

이렇게 적절한 이름으로 새 이미지를 생선한다. 만약 이미 존재하는 이름이 있다면

```
docker tag 현재 이미지 이름 새이름
docker tag node-demo:latest ijboym216/node-hello-world
```

이렇게 이미 존재하던 이전 이미지의 복제본을 생성한다. 그리고 이걸로 다시 푸시를 시도하면 푸시되는것을 알 수 있다. 그러나 여기서도 액세스 거부 메시지가 표시될것이다.

```
docker login
```

으로 한번 로그인을 해준뒤에 다시 푸시해보자.

도커는 매우 스마트한 방식으로 푸시되는데 전체 이미지를 업로드하지않는다. 대략 950Mb인 이미지파일인데, 이중 노드 이미지에 의존하고 있는건 이미 도커허브에 있기때문에 그 노드 이미지에 대한 연결을 설정하여 필요한 추가 코드만 푸시한다. **즉, 전체 노드이미지가 아닌 추가 정보만 푸시하는것이다. 도커허브에서는 공간을 절약하고, 우리는 대역폭을 절약한다.** latest는 태그를 수동으로 설정하지 않은 경우 자동으로 생성되는 태그이다.
