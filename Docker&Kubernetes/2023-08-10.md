# Imges VS Containers

- 도커로 작업 할 때 컨테이너 뿐만아니라 이미지도 가지고 있습니다. 그 차이점은 무엇이고 왜 둘 모두 필요한걸까?<br>
  결국 컨테이너는 애플리케이션, 웹사이트, 노드 서버, 애플리케이션을 실행하는 전체 환경 등, 무엇이든 포함하는 작은 패키지라는것을 배웠다.<br/>
  **즉, 컨테이너에는 소프트웨어 실행유닛이 존재한다. 결국 그 유닛을 우리가 실행하는것이다.** <u>도커로 작업할때는 이미지라는 디졸버(dissolver) 개념도 필요하다.</u>
  이미지는 템플릿, 컨테이너의 블루프린트가 될것이기때문이다. <u>이미지는 실제로 코드와 코드를 실행하는데 필요한 도구를 포함한다. 그런다음 컨테이너가 실행되어 코드를 실행한다.</u> 그리고 이 분열, 이 분리가 있다. 그것으로 이 모든 설정 명령과 모든 코드가 포함된 이미지를 한번에 생성 할 수 있다. 하지만 이 이미지를 기반으로 여러 컨테이너를 만들수있다. 예를 들어 NodeJS 웹 서버 애플리케이션의 경우 한번만 정의하면 다른 시스템과 다른 서버에서 여러번 실행 할 수 있다. <u>즉, 이미지는 모든 설정 명령과 모든 코드가 포함된 공유 가능한 패키지이다. 컨테이너는 그러한 이미지의 구체적인 실행 인스턴스이다.</u> **즉, 우리는 이미지를 기반으로 하는 컨테이너를 실행하는것이다. 이것이 핵심 기본 개념이며, 도커의 모든것이다.** 이미지와 컨테이너에서 <u>이미지는 블루 프린트</u>이고, <u>템플릿은 코드와 애플리케이션을 포함</u>하며, <u>컨테이너는 실행 애플리케이션이 된다.</u> 이는 이미지와 컨테이너로 작업을 시작하는 이 모듈을 통해 더 명확해질것이다.

# 외부(사전 빌드된)이미지의 사용 & 실행

- 컨테이너는 이미지를 기반으로 한다고 앞서 배웠다. 실제로 컨테이너를 실행 할 수 있도록 이미지를 생성하고, 가져오는 두가지 방법이 존재한다.

  1. 이미 존재하는 이미지 사용하기

     - 예를들어, 동료가 이미 구축했거나 매우 일반적이어서 미리 구축된 공식 이미지이거나 커뮤니티에서 공유한 이미지를 사용할수있다.<br/>
       이를 위한 훌륭한 소스는 도커 허브라는곳이 있다.

       ```
       docker run node
       ```

       도커가 설치 되어있는 환경에서 위의 명령어를 실행한다면, 로컬에서 해당 이미지를 찾을수 없다는 에러가 발생한다.<br/>
       그렇지만 자동으로 Docker hub에서 최신 노드 이미지를 다운하고 로컬머신에 다운이 끝난다면 해당 이미지를 컨테이너로 실행한다.<br/>
       기본적으로 컨테이너는 주변 환경과 격리되어있으며, 컨테이너 내부에서 실행중인 인터렉티브 쉘이 있다해서 이 쉘이 사용자인 우리에게 노출된다는 의미는 아니다.
       어쨌든 컨테이너는 생성되었고 실제 돌아가고있는지 살펴보자

       ```
       docker ps -a
       ```

       위의 -a를 붙히고 명령어를 실행하면 도커가 생성한 모든(all) 컨테이너, 모든 프로세스가 표시된다.<br/>
       실행해보면 1분전에 실제로 컨테이너를 생성했음을 알 수 있다. 그러나 STATUS를 보면 종료되어 더 이상 실행되지 않으며, 자동으로 생성된 이름도 받았고
       id도 있는걸알수있다. 그러나 여기서 중요한건 무언가 발생했지만 더 이상 실행되지 않는단걸 알 수 있다.<br/>
       왜냐면 앞서말했듯 컨테이너가 격리되어 실행되기때문이다. 노드를 이미지로 실행하거나 노드 이미지를 기반으로 하는 컨테이너로 실행했지만 이것만으로는 별 의미가 없다.<br/>
       노드에 의해 노출된 인터렉티브 쉘은 컨테이너에 의해 자동으로 우리에게 노출되지 않기때문이다. 그러나 이건 바꿀수있다. 아래의 명령어를 보자

       ```
       docker run -it node
       ```

       node앞에 -it가 추가된것을 볼 수 있다. 이는 도커에게 컨테이너 내부에서 호스팅 머신으로 대화형 세션을 노출하고싶다는것을 알리는것이다.<br/>
       이렇게 실행해주면 실제로 기본 노드 명령을 실행할수있는 인터렉티브 노드 터미널로 들어간다.<br/>
       **여기서 중요한 점은 여기 노드가 생성된 컨테이너 내부에서 실행중이며 -it라는 플래그를 추가함으로써 터미널로 들어가 그 컨테이너 및 컨테이너에서 실행중인 노드와 상호 작용할수있다는것이다.** 여기에서 노드는 우리의 컴퓨터에서 실행되고 있지않다. 이것을 확인하려면 컨테이너의 노드버전과 현재 로컬버전의 노드버전을 비교해보면 알 수 있다. **즉, 이 노드 컨테이너를 실행하고, 상호 작용하기위해 시스템에 노드를 설치할 필요가 전혀없는것이다.** 이것이 컨테이너 작업의 첫 번째 단계이며, 이미지와 컨테이너가 무엇인지 보여주는 시작일뿐이다. 이미지는 배후에서 컨테이너에 필요한 모든 논리와 코드를 보관하는데 사용되며 run 명령을 사용하여 이미지의 인스턴스를 만든다.그리고 이것은 이미지를 기반으로 하는 구체적인 컨테이너를 생성한다.

       ```
       docker ps -a
       ```

       를 다시 실행해보면 2개의 컨테이너가 표시될것이다. 둘 다 더이상 실행되지 않으며 종료되었다. 동일한 이미지를 기반으로 하는 컨테이너가 1개 이상 존재한다.
       그들은 더 이상 실행되지 않지만, 우리는 단순히 여러 터미널을 연다음 docker run 명령을 반복함으로써 동일한 이미지를 기반으로 하는 2개의 컨테이너가 동시에 실행될수있음을 알 수 있다. 이것이 이미지와 컨테이너의 이면에 있는 아이디어이다. **이미지에는 코드, 설정, 여러것들이 포함되며 컨테이너는 그 이미지의 실행 인스턴스이다**
