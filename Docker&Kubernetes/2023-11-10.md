# 안정적인 도메인을 위해 로드 밸런서 사용하기

## public IP주소는 업데이트된 컨테이너를 배포할때마다 변경됨

- 로드밸런서를 만든이유가 이때문임.
- ec2를 사용하진않지만 ec2로 가서 로드밸런서를 보면 우리가 생성한 로드밸런스가 있을것이다.
  - DNS name에서 도메인과 흡사한것을 찾을수있는데 이를 복사하여 /goals를 붙이면 불러올수있다.
  - 하지만 몇가지 이유로 작동안함
    - 로드밸런서의 타깃그룹에서 실수를 저지름
      - ecs서비스를 보면 서비스에 연결된 태스크가 항상 중지되고 다시 시작되는것을 알수있다.
      - 그리고 중지와 재시작은 로드밸런서에 의해 수행됨
      - 로드밸런서는 요청을 리디렉션하는 서비스의 상태를 확인하고 비정상임을 발견하면 서비스를 종료하고 다시 시작. (응답하지않는 경우)

## 에러 해결

1. 타깃 그룹 영역에서 생성한 타깃그룹을 찾자
2. Health check settings에서 edit클릭
   - 디폴트로 로드 밸런서는 배포된 서비스 '/'로 요청을 보냄
   - 현재 우리는 '/goals'로 요청을 처리함 따라서 '/' 이쪽은 404오류로 응답한다.
   - /goals로 경로 변경
3. 디폴트 보안그룹 외에 보안그룹 추가 필요
   - ECS서비스에도 사용중인 보안그룹을 첨부한 다음 save해줌
